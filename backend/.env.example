# ===========================================
# Co-Op Backend Environment Configuration
# ===========================================
# Copy this file to .env and fill in your values
# All values should be in double quotes
#
# REQUIRED variables are marked with [REQUIRED]
# OPTIONAL variables have sensible defaults or are feature-specific

# ===========================================
# Server Configuration
# ===========================================
NODE_ENV="development"
PORT="3000"
API_PREFIX="api/v1"

# ===========================================
# Database [REQUIRED]
# Neon PostgreSQL - Serverless
# Get from: https://console.neon.tech
# Use the pooled connection string for serverless
# ===========================================
DATABASE_URL="postgresql://user:password@ep-xxx.region.aws.neon.tech/dbname?sslmode=require"

# ===========================================
# Supabase [REQUIRED]
# Auth & Storage
# Get from: https://supabase.com/dashboard/project/[PROJECT]/settings/api
# ===========================================
SUPABASE_URL="https://[PROJECT].supabase.co"
SUPABASE_ANON_KEY="eyJ..."
SUPABASE_SERVICE_KEY="eyJ..."
SUPABASE_STORAGE_BUCKET="documents"

# ===========================================
# Upstash Redis [REQUIRED]
# REST API for caching
# Get from: https://console.upstash.com
# Use the REST API URL and Token
# ===========================================
UPSTASH_REDIS_URL="https://[INSTANCE].upstash.io"
UPSTASH_REDIS_TOKEN="AX..."

# ===========================================
# Upstash QStash [REQUIRED for async agents]
# Serverless Message Queue
# Used for async agent job processing
# Get from: https://console.upstash.com/qstash
# ===========================================
QSTASH_TOKEN="eyJ..."
QSTASH_CURRENT_SIGNING_KEY="sig_..."
QSTASH_NEXT_SIGNING_KEY="sig_..."
# Callback URL for QStash webhooks
# Auto-detected on Render, set manually for local development
QSTASH_CALLBACK_URL="http://localhost:3000"

# ===========================================
# LLM Providers [REQUIRED - minimum 2]
# Configure at least 2 providers for council cross-critique
# All providers offer FREE tiers
# ===========================================

# Groq - Fast inference, generous free tier
# Get from: https://console.groq.com/keys
# Models: llama-3.3-70b-versatile, kimi-k2-instruct-0905
GROQ_API_KEY="gsk_..."

# Google AI Studio - Gemini models (RECOMMENDED)
# Get from: https://aistudio.google.com/app/apikey
# Models: gemini-2.5-flash
# Also enables web research with Search Grounding
GOOGLE_AI_API_KEY="AI..."

# HuggingFace Inference API
# Get from: https://huggingface.co/settings/tokens
# Models: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B, microsoft/Phi-3-mini-4k-instruct, Qwen/Qwen2.5-14B-Instruct-1M
HUGGINGFACE_API_KEY="hf_..."

# ===========================================
# LLM Council Configuration
# Minimum 2 models required for cross-critique
# ===========================================
LLM_COUNCIL_MIN_MODELS="2"
LLM_COUNCIL_MAX_MODELS="3"

# ===========================================
# RAG Service [REQUIRED for Legal/Finance agents]
# Separate Python service for document embeddings
# See /RAG folder for setup instructions
# Domains: legal, finance
# Sectors: 70+ sectors available (fintech, healthtech, saas, ai_ml, ecommerce, etc.)
# ===========================================
RAG_SERVICE_URL="http://localhost:8000"
RAG_API_KEY="your-rag-api-key"

# ===========================================
# Web Research (Built-in)
# Primary: Google Gemini with Search Grounding
# Fallback: ScrapingBee (if Gemini fails)
# ===========================================
# Research is automatically enabled when GOOGLE_AI_API_KEY is set
# The research service uses Gemini with Google Search grounding
# for real-time web research (competitor analysis, investor search, etc.)

# ScrapingBee - Fallback web search (Optional)
# Get from: https://www.scrapingbee.com/
# Used when Gemini grounded search fails or is rate limited
SCRAPINGBEE_API_KEY=""

# ===========================================
# Notion Integration (Optional)
# Internal Integration for exporting AI outputs to Notion pages
# 
# Setup:
# 1. Go to https://www.notion.so/my-integrations
# 2. Click "New integration"
# 3. Select your workspace, give it a name
# 4. Keep "Internal integration" selected (default)
# 5. Copy the "Internal Integration Secret" → NOTION_API_TOKEN
# 6. Go to Notion, open the page you want to export to
# 7. Click "..." → "Connections" → Add your integration
# 8. Copy the page ID from URL → NOTION_DEFAULT_PAGE_ID
#    (URL format: notion.so/Page-Name-{PAGE_ID})
# ===========================================
NOTION_API_TOKEN=""
NOTION_DEFAULT_PAGE_ID=""

# ===========================================
# Security [CRITICAL]
# ===========================================

# Master API key for internal service-to-service calls
# Generate with: openssl rand -hex 32
MASTER_API_KEY=""

# Encryption key for sensitive data at rest (webhook secrets, API tokens, etc.)
# Generate with: openssl rand -hex 32
# CRITICAL: Required in production! Keep this key safe - losing it means losing access to encrypted data
# The application will fail to start in production without this key
ENCRYPTION_KEY=""

# ===========================================
# Rate Limiting
# ===========================================
THROTTLE_TTL="60"
THROTTLE_LIMIT="100"

# ===========================================
# Pilot Program Limits
# Configurable limits for scaling beyond pilot phase
# All limits can be adjusted via these env vars
# ===========================================

# Agent/Chat limits
# Maximum AI agent requests per user per month
PILOT_AGENT_MONTHLY_REQUESTS="3"

# API Key limits
# Maximum API keys per user
PILOT_API_KEY_LIMIT="1"
# Maximum API key requests per month
PILOT_API_KEY_MONTHLY_REQUESTS="3"

# Webhook limits
# Maximum webhooks per user
PILOT_WEBHOOK_LIMIT="1"
# Maximum webhook triggers per day
PILOT_WEBHOOK_DAILY_TRIGGERS="10"

# Alert limits
# Maximum alerts per user
PILOT_ALERT_LIMIT="3"

# Outreach limits
# Maximum leads per user
PILOT_LEAD_LIMIT="50"
# Maximum lead discovery requests per hour
PILOT_LEAD_DISCOVERY_HOURLY="5"
# Maximum campaigns per user
PILOT_CAMPAIGN_LIMIT="5"
# Maximum emails per day per campaign
PILOT_EMAILS_PER_DAY="50"

# ===========================================
# CORS Configuration
# Comma-separated list of allowed origins
# Use "*" for development only
# WARNING: In production, always specify explicit origins
# ===========================================
CORS_ORIGINS="http://localhost:3000,https://co-op-dev.vercel.app"

# ===========================================
# Email Service (SendGrid)
# For sending session summaries and campaign emails
# Get from: https://app.sendgrid.com/settings/api_keys
# ===========================================
SENDGRID_API_KEY=""
SENDGRID_FROM_EMAIL="noreply@your-domain.com"
SENDGRID_FROM_NAME="Co-Op AI"
# Webhook verification secret (optional)
# Get from: https://app.sendgrid.com/settings/mail_settings/event_webhook
SENDGRID_WEBHOOK_SECRET=""

# ===========================================
# App URL
# For email tracking links and OAuth callbacks
# ===========================================
APP_URL="http://localhost:3000"

# ===========================================
# Logging
# Levels: error, warn, log, debug, verbose
# ===========================================
LOG_LEVEL="debug"
